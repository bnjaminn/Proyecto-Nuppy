<!-- 
    =============================================================
    Este es el primer modal del flujo de ingreso de calificaciones.
    Permite ingresar los datos básicos de una calificación:
    - Mercado, Instrumento, Descripción
    - Fecha de pago, Secuencia de evento
    - Dividendo, Valor histórico, Factor de actualización
    - ISFUT (checkbox)
    
    Flujo:
    1. Usuario completa este formulario
    2. Al presionar "Ingresar", se guarda la calificación básica
    3. Se abre el modal 2 (factores) para ingresar montos y calcular factores
-->
<div id="ingreso-modal-overlay" class="modal-overlay">
    <div class="modal-content modal-large"> 
        <!-- CABECERA DEL MODAL -->
        <div class="modal-header">
            <h2>Ingreso de calificaciones</h2>
            <span id="btn-cerrar-modal-x" class="modal-close">&times;</span>
        </div>
        
        <!-- CUERPO DEL MODAL: FORMULARIO -->
        <div class="modal-body">
            <form id="form-ingreso" onsubmit="return false;">
                <!-- Grid de 3 filas para organizar los campos del formulario -->
                <div class="modal-form-grid-3rows"> 
                    <!-- COLUMNA IZQUIERDA: Campos principales -->
                    <!-- CAMPO MERCADO
                         =============
                         Puede mostrarse como input readonly (si hay un mercado filtrado en el dashboard)
                         o como select (si el dashboard tiene "Todos" seleccionado).
                         JavaScript controla cuál se muestra según el contexto.
                    -->
                    <div class="form-field">
                        <label for="modal-mercado">Mercado:</label>
                        <!-- Input readonly: se muestra cuando hay un mercado específico del dashboard -->
                        <input type="text" id="modal-mercado" name="mercado" readonly class="readonly-field" style="display: none;">
                        <!-- Select: se muestra cuando el dashboard tiene "Todos" seleccionado -->
                        <select id="modal-mercado-select" name="mercado" style="display: none;">
                            <option value="">Seleccione...</option>
                            <option value="acciones">Acciones</option>
                            <option value="CFI">CFI</option>
                            <option value="Fondos mutuos">Fondos mutuos</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <label for="modal-instrumento">Instrumento:</label>
                        <input type="text" id="modal-instrumento" name="instrumento" maxlength="50">
                    </div>
                    <div class="form-field">
                        <label for="modal-descripcion">Descripción:</label>
                        <input type="text" id="modal-descripcion" name="descripcion">
                    </div>
                    <div class="form-field">
                        <label for="modal-fecha_pago">Fecha Pago:</label>
                        <input type="date" id="modal-fecha_pago" name="fecha_pago">
                    </div>
                    <!-- SECUENCIA DE EVENTO: Debe ser mayor a 10,000 (validación en backend) -->
                    <div class="form-field">
                        <label for="modal-secuencia">Secuencia Evento:</label>
                        <input type="number" id="modal-secuencia" name="secuencia" min="10001">
                    </div>
                    <div class="form-field">
                        <label for="modal-dividendo">Dividendo:</label>
                        <input type="number" step="0.00000001" id="modal-dividendo" name="dividendo" value="0.0"> 
                    </div>
                    <div class="form-field">
                        <label for="modal-valor_historico">Valor Histórico:</label>
                        <input type="number" step="0.00000001" id="modal-valor_historico" name="valor_historico" value="0.0">
                    </div>
                    
                    <!-- COLUMNA DERECHA: Campos adicionales -->
                    <div class="form-field">
                        <label for="modal-factor_actualizacion">Factor de Actualización:</label>
                        <input type="number" step="0.00000001" id="modal-factor_actualizacion" name="factor_actualizacion" value="0.0">
                    </div>
                    <!-- Año: Campo editable para seleccionar el año -->
                    <div class="form-field">
                        <label for="modal-anho">Año:</label>
                        <input type="number" id="modal-anho" name="anho" min="2000" max="" step="1">
                    </div>
                    <!-- ISFUT: Checkbox para indicar si es futuro -->
                    <div class="form-field form-field-checkbox full-width"> 
                        <input type="checkbox" id="modal-isfut" name="isfut">
                        <label for="modal-isfut">ISFUT</label> 
                    </div>
                    <!-- Ejercicio: Campo oculto que se usa internamente (se copia del año) -->
                    <div class="form-field" style="display: none;">
                        <label for="modal-ejercicio">Ejercicio:</label>
                        <input type="number" id="modal-ejercicio" name="ejercicio">
                    </div>
                </div>
            </form>
        </div>

        <!-- PIE DEL MODAL: BOTONES DE ACCIÓN -->
        <div class="modal-footer">
            <button type="button" id="btn-cerrar-modal" class="btn btn-secondary">Cancelar</button>
            <!-- Botón "Ingresar": Valida el formulario y abre el modal 2 (factores) -->
            <button type="button" id="btn-siguiente-modal" class="btn">Ingresar</button> 
        </div>
    </div>
</div>
